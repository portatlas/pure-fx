<% if current_user %>
  <div class="page-header">
    <h1>Welcome!</h1>
  </div>
  <div class="panel panel-default">
    <a id="fxtran-list" href="/fxtrans" class="btn btn-info btn-lg btn-block" role="button" >FIND FX TRANSACTION NEAR YOU</a>
    <!-- ?lat=<position.coords.latitude>&lng=<position.coords.longitude> -->
    <a href="/fxtrans/new" class="btn btn-primary btn-lg btn-block" role="button" >CREATE FX REQUEST</a>
  </div>
<% else %>
  <%= render 'welcome' %>
<% end %>

<script type="text/javascript">

  var lat;
  var lng;

  var options = {
    enableHighAccuracy: true,
    timeout: 5000,
    maxmiumAge: 0
  };

  function success(pos){
    var crd = pos.coords

    // console.log('Coordinates are:');
    // console.log('Latitude: ' + crd.latitude);
    // console.log('Longitude: ' + crd.longitude);
    // console.log('Accuracy: ' + crd.accuracy);

    var lat = "latitude=" + crd.latitude;
    var lng = "longitude=" + crd.longitude;
  };

  function error(err){
    console.warn('ERROR(' + err.code + '): ' + err.message);
  }

  function storeGeolocation(){
    console.log("make ajax")
    navigator.geolocation.getCurrentPosition(success, error, options)
  };

  $("#fxtran-list").click(function(event){
    event.preventDefault();
    console.log("No clicks allowed")
    navigator.geolocation.getCurrentPosition(success, error, options)


    $.ajax({
      method: "GET",
      url: "/fxtrans/?lat=" + lat + "&lng=" + lng + "",
    })
    .done(function(msg){
      console.log(msg);
    })


  });
</script>
